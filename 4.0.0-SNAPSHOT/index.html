<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<meta name="author" content="The Thorntail Team">
<title>Thorntail Documentation</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:initial}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px 0}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:.4em .75em 0 .75em;line-height:1;vertical-align:top}
.colist>table tr>td:first-of-type img{max-width:initial}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Thorntail Documentation</h1>
<div class="details">
<span id="author" class="author">The Thorntail Team</span><br>
<span id="revnumber">version 4.0.0-SNAPSHOT</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_introduction">Introduction</a>
<ul class="sectlevel1">
<li><a href="#lessons-learned">1. Lessons Learned</a></li>
<li><a href="#_concepts">2. Concepts</a>
<ul class="sectlevel2">
<li><a href="#microservice">2.1. Microservice</a></li>
<li><a href="#cdi-native">2.2. CDI-native</a></li>
<li><a href="#microprofile-native">2.3. MicroProfile-native</a></li>
<li><a href="#flat-classpath">2.4. Flat Classpath</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_tools">Tools</a>
<ul class="sectlevel1">
<li><a href="#maven-plugin">3. Maven Plugin</a>
<ul class="sectlevel2">
<li><a href="#_modes">3.1. Modes</a></li>
<li><a href="#_formats">3.2. Formats</a></li>
<li><a href="#_code_main_code">3.3. <code>main()</code></a></li>
<li><a href="#_other_configuration">3.4. Other configuration</a></li>
<li><a href="#_distribution_structure">3.5. Distribution Structure</a></li>
</ul>
</li>
<li><a href="#maven-archetypes">4. Maven Archetypes</a>
<ul class="sectlevel2">
<li><a href="#_jax_rs">4.1. JAX-RS</a></li>
</ul>
</li>
<li><a href="#testing-junit">5. Testing with JUnit</a></li>
<li><a href="#testing-arquillian">6. Testing with Arquillian</a></li>
<li><a href="#devtools">7. Developer Tools</a></li>
</ul>
</li>
<li><a href="#_components">Components</a>
<ul class="sectlevel1">
<li><a href="#bom-maven">8. Using the BOM with Maven</a></li>
<li><a href="#component-kernel">9. Kernel</a>
<ul class="sectlevel2">
<li><a href="#_configuration">9.1. Configuration</a></li>
</ul>
</li>
<li><a href="#_java_ee">10. Java EE</a>
<ul class="sectlevel2">
<li><a href="#component-bean-validation">10.1. Bean Validation</a></li>
<li><a href="#component-servlet">10.2. Servlet</a></li>
<li><a href="#component-jaxrs">10.3. JAX-RS</a></li>
<li><a href="#component-websockets">10.4. WebSockets</a></li>
<li><a href="#component-json-p">10.5. JSON-P</a></li>
<li><a href="#component-jndi">10.6. JNDI</a></li>
<li><a href="#component-jdbc">10.7. JDBC</a></li>
<li><a href="#component-datasources">10.8. DataSources</a></li>
<li><a href="#component-jpa">10.9. JPA</a></li>
<li><a href="#component-jta">10.10. JTA</a></li>
<li><a href="#component-jca">10.11. JCA</a></li>
<li><a href="#component-jms">10.12. JMS</a></li>
<li><a href="#component-jms-artemis">10.13. JMS-Artemis</a></li>
</ul>
</li>
<li><a href="#_microprofile">11. MicroProfile</a>
<ul class="sectlevel2">
<li><a href="#component-config">11.1. Config</a></li>
<li><a href="#component-faulttolerance">11.2. Fault Tolerance</a></li>
<li><a href="#component-health">11.3. Health</a></li>
<li><a href="#component-metrics">11.4. Metrics</a></li>
<li><a href="#component-openapi">11.5. OpenAPI</a></li>
<li><a href="#component-opentracing">11.6. OpenTracing</a>
<ul class="sectlevel3">
<li><a href="#component-opentracing-jaeger">11.6.1. OpenTracing with Jaeger</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_other">12. Other</a>
<ul class="sectlevel2">
<li><a href="#component-vertx">12.1. Vert.x</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_guides">Guides</a>
<ul class="sectlevel1">
<li><a href="#build-from-source">13. Build Thorntail from Source</a></li>
<li><a href="#guide-container-layers">14. How to build Linux Containers as Layers</a></li>
<li><a href="#guide-container-fabric8">15. How to build Linux Containers using Fabric8 Maven Plugin</a></li>
<li><a href="#using-log4j">16. Using log4j</a></li>
</ul>
</li>
<li><a href="#_appendix">Appendix</a>
<ul class="sectlevel1">
<li><a href="#license">17. License</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="images/thorntail-logo.png" alt="thorntail logo">
</div>
</div>
<div class="paragraph">
<div class="title">About</div>
<p><em>Thorntail</em> is the new name of <em>WildFly Swarm</em>.
This documentation applies to the <em>proof of concept</em> for v4.x of the project.</p>
</div>
<div class="paragraph">
<div class="title">Other Formats</div>
<p>This documentation also available <a href="thorntail-docs-4.0.0-SNAPSHOT.pdf">in PDF format</a>.</p>
</div>
</div>
</div>
<h1 id="_introduction" class="sect0"><a class="anchor" href="#_introduction"></a>Introduction</h1>
<div class="sect1">
<h2 id="lessons-learned"><a class="anchor" href="#lessons-learned"></a>1. Lessons Learned</h2>
<div class="sectionbody">
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>We&#8217;ve spent a couple of years building and living with the current Thorntail (née WildFly Swarm) codebase.
Over this time, we&#8217;ve learned a few things from our own experiences and those of our community.
These are their stories.</p>
</div>
</div>
</div>
<div class="paragraph">
<div class="title">Mangling artifacts is dangerous</div>
<p>When you mangle and repackage a user&#8217;s artifacts and dependencies, it can many times go awry.</p>
</div>
<div class="paragraph">
<div class="title">Don&#8217;t replace Maven</div>
<p>Let Maven (or Gradle) handle the entirety of pulling dependencies. We cannot predict the topology of someone&#8217;s repository managers, proxies and network.</p>
</div>
<div class="paragraph">
<div class="title">Don&#8217;t get complicated with uberjars</div>
<p>The more complex our uberjar layout is, the harder it is to support Gradle or other non-Maven build systems.</p>
</div>
<div class="paragraph">
<div class="title">Classpaths are tricky</div>
<p>If different codepaths are required for executing from Maven, an IDE, a unit-test, and during production, you will have a <strong>bad time</strong>.</p>
</div>
<div class="paragraph">
<div class="title">Don&#8217;t insist on uberjars</div>
<p>For Linux containers, people want layers that cleanly separate application code from runtime support code.</p>
</div>
<div class="paragraph">
<div class="title">Testability is important</div>
<p>A slow test is a test that is never willingly executed. PRs take forever to validate. Users like to be able to test their own code quickly and iteratively.</p>
</div>
<div class="paragraph">
<div class="title">Easily extensible means ecosystem</div>
<p>If it&#8217;s entirely too difficult to extend the platform, the ecosystem will not grow. New integrations should be simple.</p>
</div>
<div class="paragraph">
<div class="title">Related: Core things should not be any more first-class than community contributions</div>
<p>For instance, auto-detection in WildFly Swarm only worked with core fractions; user-provided wouldn&#8217;t auto-detect.</p>
</div>
<div class="paragraph">
<div class="title">Ensure the public-vs-private API guarantees are clear.</div>
<p>Intertwingly code (and javadocs) make finding the delineation between public API and private implementations difficult.</p>
</div>
<div class="paragraph">
<div class="title">Allow BYO components</div>
<p>We don&#8217;t want to decide <em>all</em> of the implementations, and certainly not versions, of random components we support.</p>
</div>
<div class="paragraph">
<div class="title">Be a framework, not a platform</div>
<p>Frameworks are easier to integrate into an existing app; a platform becomes the target with (generally too many) constraints.</p>
</div>
<div class="paragraph">
<div class="title">Maintain tests &amp; documentation</div>
<p>Ensure the definition of "done" includes both tests and documentation.</p>
</div>
<div class="paragraph">
<div class="title">Productization complexity</div>
<p>The greater divergence between community and product, the more effort is required for productization.
Complicating any process to automate productization from community.</p>
</div>
<div class="paragraph">
<div class="title">BOM complexity</div>
<p>Related to productization as well, but of itself having a handful of BOMs made life confusing for us and for users.
There were often times where fractions would be "Unstable" or "Experimental" for months with no real reason other than we forgot to update it.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_concepts"><a class="anchor" href="#_concepts"></a>2. Concepts</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="microservice"><a class="anchor" href="#microservice"></a>2.1. Microservice</h3>
<div class="paragraph">
<p>A microservice is small application with a <em>bounded domain</em>.
A microservice is intended to solve a semantically constrained problem related to a larger system.
In a microservice-based architecture, an <em>application</em> is made from a collection of many <em>microservices</em>.</p>
</div>
</div>
<div class="sect2">
<h3 id="cdi-native"><a class="anchor" href="#cdi-native"></a>2.2. CDI-native</h3>
<div class="paragraph">
<p>Thorntail is built from the from ground-up to be CDI-native.
Building applications of any notable size benefit from the usage of a dependency-injection framework.</p>
</div>
</div>
<div class="sect2">
<h3 id="microprofile-native"><a class="anchor" href="#microprofile-native"></a>2.3. MicroProfile-native</h3>
<div class="paragraph">
<p>Thorntail is built from the from ground-up to be MicroProfile-native.
MicroProfile addresses many of the needs and requirements of microservices-centric applications.
Instead of bolting MicroProfile facilities on, Thorntail natively supports the various MicroProfile specifications directly.</p>
</div>
</div>
<div class="sect2">
<h3 id="flat-classpath"><a class="anchor" href="#flat-classpath"></a>2.4. Flat Classpath</h3>
<div class="paragraph">
<p>While Java application servers previously have had the ability to support multiple disparate applications, when building microservices, a runtime need only support a single application, or service.
With a microservices architecture, significantly fewer resources and capabilities may be required for each service.
Freely mixing service and application implementations becomes significantly less problematic and certainly less cumbersome.</p>
</div>
<div class="paragraph">
<p>That being said, the Java Platform Module System (JPMS) may become beneficial in the future after further adoption by other upstream projects.</p>
</div>
</div>
</div>
</div>
<h1 id="_tools" class="sect0"><a class="anchor" href="#_tools"></a>Tools</h1>
<div class="sect1">
<h2 id="maven-plugin"><a class="anchor" href="#maven-plugin"></a>3. Maven Plugin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>thorntail-maven-plugin</code> exists to make packaging your application easier.</p>
</div>
<div class="paragraph">
<div class="title">Basic Configuration</div>
<p>As with any Maven plugin, configuration occurs within your project&#8217;s <code>pom.xml</code></p>
</div>
<div class="paragraph">
<p>The plugin has one available goal: <code>package</code>.
The behavior of this goal is controlled by the plugin configuration, described below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;plugin&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;version&gt;</span>4.0.0-SNAPSHOT<span class="tag">&lt;/version&gt;</span>
  <span class="tag">&lt;configuration&gt;</span>
    <span class="comment">&lt;!-- global configuration --&gt;</span>
  <span class="tag">&lt;/configuration&gt;</span>
  <span class="tag">&lt;executions&gt;</span>
    <span class="tag">&lt;execution&gt;</span>
      <span class="tag">&lt;goals&gt;</span>
        <span class="tag">&lt;goal&gt;</span>package<span class="tag">&lt;/goal&gt;</span>
      <span class="tag">&lt;/goals&gt;</span>
      <span class="tag">&lt;configuration&gt;</span>
        <span class="comment">&lt;!-- execution-specific configuration --&gt;</span>
      <span class="tag">&lt;/configuration&gt;</span>
    <span class="tag">&lt;/execution&gt;</span>
  <span class="tag">&lt;/executions&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_modes"><a class="anchor" href="#_modes"></a>3.1. Modes</h3>
<div class="paragraph">
<p>The plugin can operate in two modes: <em>fat</em> and <em>thin</em>, with <em>fat</em> being the default.
The mode is selected by a <code>&lt;mode&gt;&#8230;&#8203;&lt;/mode&gt;</code> block within the plugin configuration, or by the <code>thorntail.mode</code> property.</p>
</div>
<div class="paragraph">
<div class="title">fat</div>
<p>Produces an executable build that includes all dependencies and your application artifact.</p>
</div>
<div class="paragraph">
<div class="title">thin</div>
<p>Produces an executable build that includes all dependencies but <em>not</em> your application artifact.</p>
</div>
<div class="paragraph">
<p><em>Mode</em> is an independent concept from <em>format</em>, described below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;configuration&gt;</span>
  <span class="tag">&lt;mode&gt;</span>thin<span class="tag">&lt;/mode&gt;</span>
<span class="tag">&lt;/configuration&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_formats"><a class="anchor" href="#_formats"></a>3.2. Formats</h3>
<div class="paragraph">
<p>The plugin can produce three different types of executable distributions: <em>jar</em>, <em>dir</em>, and <em>zip</em>, with <em>jar</em> being the default.
The format is selected by a <code>&lt;format&gt;&#8230;&#8203;&lt;/format&gt;</code> block within the plugin configuration, or by the <code>thorntail.format</code> property.
These contents of any of these formats is still defined by the <em>mode</em>, described above.</p>
</div>
<div class="paragraph">
<div class="title">jar</div>
<p>Produces a fat jar (or <em>überjar</em>) containing the cotnents defined by the <em>mode</em> above.
The jar may be executed using normal <code>java -jar</code> commands.</p>
</div>
<div class="paragraph">
<div class="title">dir</div>
<p>Produces a directory containing the contents defined by the <code>mode</code> above, along with scripts to easily execute it.
The <em>dir</em> layout may be best suited for container-related pipelines, where all runtime support aspects are added to a base layer, and the topmost layer contains only the vanillia application artifact.
To achieve this method, <code>mode</code> should be configured to be <code>thin</code>.</p>
</div>
<div class="paragraph">
<div class="title">zip</div>
<p>Produces the same content as the <em>dir</em> format, but as a <code>.zip</code> file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;configuration&gt;</span>
  <span class="tag">&lt;format&gt;</span>dir<span class="tag">&lt;/format&gt;</span>
<span class="tag">&lt;/configuration&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_code_main_code"><a class="anchor" href="#_code_main_code"></a>3.3. <code>main()</code></h3>
<div class="paragraph">
<p>The plugin will attempt to discover an existing non-ambiguous <code>main(&#8230;&#8203;)</code> within your application.
If it finds none, a default <code>main(&#8230;&#8203;)</code> will be configured.
If it finds a single application-provided <code>main(&#8230;&#8203;)</code>, it will be used.
If it finds multiple application-provided <code>main(&#8230;&#8203;)</code> methods, an error will result.
To resolve an ambiguous <code>main(&#8230;&#8203;)</code> error, a <code>mainClass</code> may be configured using a <code>&lt;mainClass&gt;&#8230;&#8203;&lt;/mainClass&gt;</code> block within the plugin configuration, or by the <code>thorntail.mainClass</code> property.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;configuration&gt;</span>
  <span class="tag">&lt;mainClass&gt;</span>com.mycorp.myapp.Main<span class="tag">&lt;/mainClass&gt;</span>
<span class="tag">&lt;/configuration&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_other_configuration"><a class="anchor" href="#_other_configuration"></a>3.4. Other configuration</h3>
<div class="paragraph">
<div class="title">Naming</div>
<p>The artifact produced will include the Maven classifier of <code>-bin</code>.
This classifier may be changed using the <code>&lt;classifier&gt;&#8230;&#8203;&lt;/classifier&gt;</code> configuration element, or <code>thorntail.classifier</code> property.</p>
</div>
<div class="paragraph">
<p>The artifact will be named the same as the primary project artifact (according to <code>${project.finalName}</code>), unless a plugin configuration of <code>&lt;finalName&gt;&#8230;&#8203;&lt;/finalName&gt;</code> or a property of <code>thorntail.finalName</code> is provided.</p>
</div>
<div class="paragraph">
<div class="title">Attaching</div>
<p>If the format is <code>jar</code> or <code>zip</code>, it will be attached to the Maven project, causing it to be built or deployed to the repository.
If the format is <code>dir</code>, it can not be attached.</p>
</div>
<div class="paragraph">
<p>To disable attaching of a <code>jar</code> or <code>zip</code> build, a configuration block of <code>&lt;attach&gt;&#8230;&#8203;&lt;/attach&gt;</code> or property of <code>thorntail.attach</code> may be set to <code>false</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_distribution_structure"><a class="anchor" href="#_distribution_structure"></a>3.5. Distribution Structure</h3>
<div class="paragraph">
<div class="title">Directory and Zip</div>
<p>When <code>dir</code> or <code>zip</code> formats are selected, the layout of the resulting tree is relatively simple:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>bin/</code></dt>
<dd>
<p>Directory containing platform-specific scripts to execute the application.</p>
</dd>
<dt class="hdlist1"><code>bin/run.sh</code></dt>
<dd>
<p>A Unix-compatible shell script for launching the application.
If the distribution was built as a <code>thin</code> distribution, the application archive must be provided in one of two ways:</p>
<div class="ulist">
<ul>
<li>
<p>As an argument to the <code>run.sh</code> command.</p>
</li>
<li>
<p>By placing it within the <code>app/</code> directory.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><code>bin/run.bat</code></dt>
<dd>
<p>A Windows-compatible batch script for launching the application.
If the distribution was built as a <code>thin</code> distribution, the application archive must be provided in one of two ways:</p>
<div class="ulist">
<ul>
<li>
<p>As an argument to the <code>run.bat</code> command.</p>
</li>
<li>
<p>By placing it within the <code>app/</code> directory.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><code>app/</code></dt>
<dd>
<p>A directory to contain the application archive.
If the distribution was built as a <code>thin</code> distribution, this directory will be empty.
When using containers, the top-most layer may be responsible for placing the application archive in this location, or may mount the archive into this directory when run.</p>
</dd>
<dt class="hdlist1"><code>lib/</code></dt>
<dd>
<p>Contains all dependencies for the application.
Care is taken to ensure last-modified timestamps of the contents of this directly do not change needlessly.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<div class="title">Jar</div>
<p>When the <code>jar</code> format is selected, the contents of the jar are also relatively simple:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>*.jar</code></dt>
<dd>
<p>All <code>.jar</code> archives are placed within the root of the resulting <code>-bin.jar</code>.</p>
</dd>
<dt class="hdlist1"><code>bin/Run.class</code></dt>
<dd>
<p>A bootstrapping class is provided which can set up the classpath given the contents at the root of the jar.
The bootstrap class will extract all of the <code>.jar</code> artifacts from the root to a cache directory at <code>$HOME/.thorntail-cache</code>.
The extracted jars will have a SHA-1 hash added to their names in order to disambiguate any identically named jars from this or other applications, as the cache is shared.</p>
</dd>
<dt class="hdlist1"><code>META-INF/MANIFEST.MF</code></dt>
<dd>
<p>The Jar manifest is configured to run the <code>bin.Run</code> main bootstrapping class when <code>java -jar</code> is used.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="maven-archetypes"><a class="anchor" href="#maven-archetypes"></a>4. Maven Archetypes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Maven archetypes are provided to make it quick to get started with new Thorntail projects.</p>
</div>
<div class="sect2">
<h3 id="_jax_rs"><a class="anchor" href="#_jax_rs"></a>4.1. JAX-RS</h3>
<div class="listingblock">
<div class="title">Maven Coordinates</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail.archetypes<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-jaxrs-archetype<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Create a new project</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell">mvn archetype:generate \
    -DarchetypeGroupId=io.thorntail.archetypes \
    -DarchetypeArtifactId=thorntail-jaxrs-archetype \
    -DarchetypeVersion=4.0.0-SNAPSHOT \
    -DgroupId=com.mycorp \
    -DartifactId=my-app \
    -Dversion=1.0-SNAPSHOT</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your project will be created in the <code>my-app/</code> directory, and contain stubs to get your started.
These stubs include a JUnit-based test, along with appropriate configuration of your <code>pom.xml</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing-junit"><a class="anchor" href="#testing-junit"></a>5. Testing with JUnit</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Thorntail provides a JUnit <code>TestRunner</code> implementation which allows your JUnit tests to execute within the context of your full application.
To use the <code>TestRunner</code>, you must include the <code>testing</code> artifact with <code>&lt;scope&gt;test&lt;/scope&gt;</code>.</p>
</div>
<div class="listingblock">
<div class="title">Maven Coordinates</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-testing<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Use the <code>ThorntailRunner`</code></div>
<p>Write your JUnit test as usual, but include a class-level annotation of <code>@RunWith(ThorntailRunner.class)</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@RunWith</span>(ThorntailRunner.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyTest</span> {
  <span class="comment">// tests go here</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Participate in CDI</div>
<p>Your test class will be instantiated and injected for each test method.
You may use <code>@Inject</code> to inject any component available to your application.
The entirety of your application will be booted and available.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@RunWith</span>(ThorntailRunner.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyTest</span> {

  <span class="directive">public</span> <span class="type">void</span> testSomething() <span class="directive">throws</span> <span class="exception">Exception</span> {
    assertThat(myLunch.getCheese()).isEqualTo(<span class="string"><span class="delimiter">&quot;</span><span class="content">cheddar</span><span class="delimiter">&quot;</span></span>);
  }

  <span class="annotation">@Inject</span>
  <span class="directive">private</span> Lunch myLunch;
}</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Use <code>@EphemeralPorts</code></div>
<p>If the annotation <code>@EphemeralPorts</code> is applied at the class level, and your application uses a servlet container, then arbitrary emphemeral ports will be selected and used.
This may be useful when running tests on a CI machine or if you wish to parallelize your tests.</p>
</div>
<div class="paragraph">
<p>In order to know what port are actually selected and in-use, you may <code>@Inject</code> either a <code>@Primary</code> or <code>@Management</code> <code>URL</code> or <code>InetSocketAddress</code> component.
These instances are made available throw the <a href="#component-servlet">Servlet</a> component.</p>
</div>
<div class="paragraph">
<div class="title">fest-assert</div>
<p>The <code>testing</code> artifact transitively brings in <a href="https://github.com/alexruiz/fest-assert-2.x">fest-assert</a> for making fluent assertions in your tests.</p>
</div>
<div class="paragraph">
<div class="title">RestAssured</div>
<p>The <code>testing</code> artifact transitively brings in <a href="http://rest-assured.io/">RestAssured</a> to enable easily testing of HTTP endpoints.
Additionally, it preconfigures the <code>RestAssured.baseURI</code> to the URL for the primary web endpoint, if available.
The preconfiguration of the <code>baseURI</code> is especially useful when you use <code>@EphemeralPorts</code>.</p>
</div>
<div class="paragraph">
<div class="title">Related Information</div>
<p><a href="#testing-arquillian">Testing with Arquillian</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing-arquillian"><a class="anchor" href="#testing-arquillian"></a>6. Testing with Arquillian</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Arquillian is a framework which assists with both blackbox and <em>in-container</em> testing of your components.
The MicroProfile TCKs use the Arquillian framework in order to verify compliance with the specifications.</p>
</div>
<div class="paragraph">
<div class="title">Maven Coordinates</div>
<p>To use the Arquillian integration, include the <code>testing-arquillian</code> artifact in your project with a <code>&lt;scope&gt;test&lt;/scope&gt;</code> block.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-testing-arquillian<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Arquilian Deployable Container</div>
<p>Thorntail provides an Arquillian-compatible <em>deployable container</em> which allows a developer to deploy only the components they wish to test.
Additionally, the tests themselves may either be blackbox (<code>@RunAsClient</code>) or <em>in-container</em> where they can directly interact with the components under test.</p>
</div>
<div class="paragraph">
<div class="title">Writing an <em>in-container</em> Test</div>
<p>Using JUnit, write a test as you normally would, but include a class-level annotation of <code>@RunWith(Arquillian.class)</code>.</p>
</div>
<div class="paragraph">
<p>Additionally, to specify the components you wish to be tested, you must provide a method marked <code>@Deployment</code> which produces a ShrinkWrap archive to be consider as the application.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@RunWith</span>(Arquillian.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyTest</span> {

  <span class="annotation">@Deployment</span>
  <span class="directive">public</span> <span class="directive">static</span> JavaArchive myDeployment() {
    JavaArchive archive = ShrinkWrap.create(JavaArchive.class);
    <span class="comment">// set up archive</span>
    <span class="keyword">return</span> archive;
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For in-container tests, the test class itself (<code>MyTest</code> in this case) is considered an injectable CDI bean.
Any components your application creates, or which are normally available from Thorntail may be injected.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@RunWith</span>(Arquillian.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyTest</span> {

  <span class="annotation">@Deployment</span>
  <span class="directive">public</span> <span class="directive">static</span> JavaArchive() {
    JavaArchive archive = ShrinkWrap.create(JavaArchive.class);
    <span class="comment">// set up archive</span>
    <span class="keyword">return</span> archive;
  }

  <span class="directive">public</span> <span class="type">void</span> testSomething() <span class="directive">throws</span> <span class="exception">Exception</span> {
    assertThat(myLunch.getCheese()).isEqualTo(<span class="string"><span class="delimiter">&quot;</span><span class="content">cheddar</span><span class="delimiter">&quot;</span></span>);
  }


  <span class="annotation">@Inject</span>
  <span class="directive">private</span> Lunch myLunch;

}</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Related Information</div>
<p><a href="#testing-junit">Testing with JUnit</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="devtools"><a class="anchor" href="#devtools"></a>7. Developer Tools</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Thorntail provides a set of developer tools to allow for restarting or reloading classes when developing a Thorntail-based application.
The simple ability to restart a running process when compiled <code>.class</code> files or packaged <code>.jar</code> files are changed is built in to the core.
To gain the ability to hot reload classes into an running executable, an additional dependency is required.</p>
</div>
<div class="listingblock">
<div class="title">Maven Coordinates</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-devtools<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Setting the <code>THORNTAIL_DEV_MODE</code></div>
<p>To enable either the restarting of processes or hot-reloading of classes, the environment variable <code>THORNTAIL_DEV_MODE</code> must be set.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>restart</code></dt>
<dd>
<p>Capability always included in the core, which will watch the contents of the classpath.
Upon noticing changes, the process will be terminated and restarted, causing the JVM to load new versions of all classes.</p>
</dd>
<dt class="hdlist1"><code>reload</code></dt>
<dd>
<p>Capbility only available if the above <code>thorntail-devtools</code> dependency is added to the project.
It will watch for changes to the contents of the classpath (only <code>.class</code> files, not packaged <code>.jar</code> files) and attempt to load and redefine the classes within the running process.</p>
</dd>
<dt class="hdlist1"><code>debug</code></dt>
<dd>
<p>Capbility always included in the core, which only enables remote debug mode for the JVM.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<div class="title">Using <code>restart</code> mode</div>
<p>Restart works primarily with directory layouts.
The provided <code>bin/run.sh</code> will use either the application&#8217;s own packaged <code>.jar</code> if built using <code>&lt;mode&gt;fat&lt;/mode&gt;</code> or will attempt to use <code>target/classes/</code> if built with <code>&lt;mode&gt;thin&lt;/mode&gt;</code>.
Start the process with the environment variable set to <code>restart</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell">$ THORNTAIL_DEV_MODE=restart ./target/myapp-bin/bin/run.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then rebuild your project as appropriate</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell">$ mvn compile</code></pre>
</div>
</div>
<div class="paragraph">
<p>Within the console of the running process, you should see, within a few seconds, the process stop and restart automatically.</p>
</div>
<div class="paragraph">
<div class="title">Using <code>reload</code> mode</div>
<p>Add the above Maven <code>&lt;dependency&gt;</code> block to your project.</p>
</div>
<div class="paragraph">
<p>Then follow the same steps as for <code>restart</code>, but setting the mode to <code>reload</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell">$ THORNTAIL_DEV_MODE=reload ./target/myapp-bin/bin/run.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>The rebuilt your project as appropriate</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell">$ mvn compile</code></pre>
</div>
</div>
<div class="paragraph">
<p>Additionally, the same behavior is available if you execute your <code>main()</code> directly from your IDE with the environment variable set appropriately.
Triggering a recompilation from within your IDE should also cause hot reloading of your classes within the running process.</p>
</div>
<div class="paragraph">
<div class="title">Using <code>debug</code> mode</div>
<p>This mode simply enables the remote JVM debug protocol on port <code>8000</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell">$ THORNTAIL_DEV_MODE=debug ./target/myapp-bin/bin/run.sh</code></pre>
</div>
</div>
</div>
</div>
<h1 id="_components" class="sect0"><a class="anchor" href="#_components"></a>Components</h1>
<div class="sect1">
<h2 id="bom-maven"><a class="anchor" href="#bom-maven"></a>8. Using the BOM with Maven</h2>
<div class="sectionbody">
<div class="paragraph">
<div class="title">Use the BOM</div>
<p>All components and dependencies of Thorntail are version-managed in a <em>Bill of Materials</em> (BOM).
Within your <code>pom.xml</code> you would <code>import</code> this BOM within a <code>&lt;dependencyManagement&gt;</code> stanza.
This allows you to reference any Thorntail component or verified version of a dependency without having to specify the <code>&lt;version&gt;</code> of each.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependencyManagement&gt;</span>
  <span class="tag">&lt;dependencies&gt;</span>
    <span class="tag">&lt;dependency&gt;</span>
      <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
      <span class="tag">&lt;artifactId&gt;</span>thorntail-bom<span class="tag">&lt;/artifactId&gt;</span>
      <span class="tag">&lt;version&gt;</span>4.0.0-SNAPSHOT<span class="tag">&lt;/version&gt;</span>
      <span class="tag">&lt;type&gt;</span>pom<span class="tag">&lt;/type&gt;</span>
      <span class="tag">&lt;scope&gt;</span>import<span class="tag">&lt;/scope&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>
  <span class="tag">&lt;/dependencies&gt;</span>
<span class="tag">&lt;/dependencyManagement&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="component-kernel"><a class="anchor" href="#component-kernel"></a>9. Kernel</h2>
<div class="sectionbody">
<div class="paragraph">
<div class="title">Maven Coordinates</div>
<p>The core of Thorntail is usually brought in transitively through other dependencies.
It&#8217;s Maven coordinates are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-kernel<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="dlist">
<div class="title">CDI Components</div>
<dl>
<dt class="hdlist1"><code>ThreadFactoryProducer</code></dt>
<dd>
<p>Produces a <code>Dependent</code> scoped <code>ThreadFactory</code> for utilizing <code>Thread</code> instances.</p>
</dd>
<dt class="hdlist1"><code>IndexProducer</code></dt>
<dd>
<p>Produces an <code>Application</code> scoped <code>IndexView</code> representing the jandex&#8217;d files of the Deployment,
read from <code>META-INF/thorntail.idx</code> which is created by the plugin.
If not found, it produces an empty <code>IndexView</code> instance.</p>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="_configuration"><a class="anchor" href="#_configuration"></a>9.1. Configuration</h3>
<div class="paragraph">
<p>Configuration of applications built on Thorntail is performed using MicroProfile-config mechanisms.
The default <code>microprofile-config.properties</code> file located within the <code>META-INF/</code> directory of the application can be used to set or override default configuration values.
The same file may be used to provide application-specific configuration which does not directly affect the Thorntail behavior.</p>
</div>
<div class="paragraph">
<p>Additionally, other files, both within <code>META-INF/</code> and on the filesystem may contribute to the final configuration, with various degrees of priority.
The priority may be controlled on a file-by-file basis using the MicroProfile-config <code>config_ordinal</code> property within each file.
Files with larger priorities will override values set in files with lower priorities.</p>
</div>
<div class="paragraph">
<div class="title">Profiles</div>
<p>Configuration files may be conditionally activated using <em>profiles</em>.
Profiles are activated by setting the Java system property of <code>thorntail.profiles</code> or the system environment variable of <code>THORNTAIL_PROFILES</code> to a comma-separated list of names.</p>
</div>
<div class="paragraph">
<div class="title">Search Paths &amp; Explicit Configuration Files</div>
<p>To externalize configuration, the Java system property of <code>thorntail.config.location</code> or the system environment variable of <code>THORNTAIL_CONFIG_LOCATION</code> may be set to a system-dependent delimited set of paths.
Each path is considered in turn, withi increasing priority.
If a path is a directory, it will be searched for appropriate configuration files matching any activated profiles.
If a path is a regular file, it will be loaded, regardless of name or activated profiles.</p>
</div>
<div class="paragraph">
<div class="title">YAML</div>
<p>If the application includes a dependency on <code>snakeyaml</code>, then YAML-based configuration files will also be located and loaded.</p>
</div>
<div class="paragraph">
<div class="title">Environment Variables</div>
<p>All configuration items may be set through environment variables.
As the format used for many configuration keys may include characters not allowed as environment variable names, a mechanical translation is performed.
A requested configuration key is converted to uppercase, and each dot is replaced with an underscore.
For example, a configuration key of <code>web.primary.port</code> may be configured through an environment variable named <code>WEB_PRIMARY_PORT</code>.</p>
</div>
<div class="paragraph">
<div class="title">Framework Defaults</div>
<p>Each framework component may include default values for any required configuration item.
These defaults have a priority of <code>-1000</code> to allow easy overriding of them.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Configuration Sources</caption>
<colgroup>
<col style="width: 42.8571%;">
<col style="width: 14.2857%;">
<col style="width: 42.8572%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Path</th>
<th class="tableblock halign-left valign-top">Priority</th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>META-INF/framework-defaults.propertes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Located via classloader and provided by framework components.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>META-INF/microprofile.propertes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Located via classloader.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>META-INF/application.properties</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Located via classloader.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>META-INF/application.yaml</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Located via classloader, if SnakeYAML is available</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>META-INF/application-<em>profile</em>.properties</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">250+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Located via classloader, in order specified, with increasing priority.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>META-INF/application-<em>profile</em>.yaml</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">250+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Located via classloader, in order specified, with increasing priority.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>application-<em>profile</em>.properties</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">250+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Located via filesystem from specified search paths, in order, with increasing priority.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>application-<em>profile</em>.yaml</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">250+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Located via filesystem from specified search paths, in order, with increasing priority.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>path</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">275</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Located via filesystem, through explicit property or environment variable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>environment variables</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">300</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Converted from all available system environment variables.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>system properties</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All available system properties.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Interpolation</div>
<p>Configuration values may be interpreted and assembled from other values.
Interpolation expressions are wrapped within delimeters of `${' and `}'.
Additionally, expressions may provide a default value, which may in turn be another expression or a literal.
All interpolation is performed before using the value converters to convert to the desired type.</p>
</div>
<div class="paragraph">
<p>As with normal usage of <code>Config</code>, if an interpolation expression references a configuration key and provides no default, if that key does not exist, a <code>NoSuchElementException</code> will be thrown.</p>
</div>
<div class="paragraph">
<p>In the event that a literal <code>${</code> is desired within a value, without interpolation, a <code>\</code> character may be used to escape it.</p>
</div>
<div class="paragraph">
<p>All other <code>\</code> which appear before any other character will be included literally in the value, not as an escape.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>${web.primary.port}</code></dt>
<dd>
<p>Will be replaced with the current value of the configuration item <code>web.primary.port</code> if it exists.
If no such value exists, an exception will be thrown.</p>
</dd>
<dt class="hdlist1"><code>${web.primary.port:8080}</code></dt>
<dd>
<p>Will be replaced with the current value of the configuration item <code>web.primary.port</code> if it exists.
If no such value exists, the value of <code>8080</code> will be provided, and converted as appropriate.</p>
</dd>
<dt class="hdlist1"><code>${web.management.port:${web.primary.port:8080}}</code></dt>
<dd>
<p>Will be replaced with the current value of the configuration item <code>web.management.port</code> if it exists.
If not such value exists, will be replaced by the current value of the configuration item <code>web.primary.port</code> if it exists.
If no such value exists, the value of <code>8080</code> will be provided, and converted as appropriate.</p>
</dd>
<dt class="hdlist1"><code>thing-${thing.type:default}-impl</code></dt>
<dd>
<p>Will be a combination of the literal <code>thing-</code> text, the value of <code>thing.type</code> configuration item` if present, using the word 'default' if not, with a suffix of <code>-impl</code>.</p>
</dd>
<dt class="hdlist1"><code>%40-$</code></dt>
<dd>
<p>Will result in a string literal of <code>%40-$</code></p>
</dd>
<dt class="hdlist1"><code>\${foo}</code></dt>
<dd>
<p>Will result in a string literal of <code>${foo}</code> without interpolation, removing the escape character.</p>
</dd>
<dt class="hdlist1"><code>foo\,bar</code></dt>
<dd>
<p>Will result in a string literal of <code>foo\,bar</code> without removal of the escape character.</p>
</dd>
</dl>
</div>
<div class="ulist">
<div class="title">Related Information</div>
<ul>
<li>
<p><a href="https://microprofile.io/project/eclipse/microprofile-config/spec/src/main/asciidoc/microprofile-config-spec.asciidoc">MicroProfile Configuration Spec</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_java_ee"><a class="anchor" href="#_java_ee"></a>10. Java EE</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="component-bean-validation"><a class="anchor" href="#component-bean-validation"></a>10.1. Bean Validation</h3>
<div class="paragraph">
<p>The Bean Validation component provides for using <em>bean validation</em> according to JSR 380.</p>
</div>
<div class="listingblock">
<div class="title">Maven Coordinates</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-bean-validation<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">CDI Components</div>
<p>Injectable components are defined by the <a href="http://beanvalidation.org/2.0/spec/#integration-cdi">Bean Validation specification</a>.</p>
</div>
<div class="ulist">
<div class="title">Related Information</div>
<ul>
<li>
<p><a href="#component-datasources">DataSources</a></p>
</li>
<li>
<p><a href="#component-jms">JMS</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="component-servlet"><a class="anchor" href="#component-servlet"></a>10.2. Servlet</h3>
<div class="paragraph">
<p>The Servlet component of Thorntail enables basic Java Web Servlet processing and serving.</p>
</div>
<div class="paragraph">
<div class="title">Maven Coordinates</div>
<p>To include the servlet component, add a dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-servlet<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Implicit Deployment</div>
<p>An application archive will be scanned for all <code>Servlet</code> implementations and added to a default deployment.
The <code>@WebServlet</code> annotation should be used to configure the servlet as desired.</p>
</div>
<div class="paragraph">
<div class="title">Explicit Deployments</div>
<p>To have more control over the deployment, the application may use normal CDI facilities to produce instances of <code>DeploymentMetaData</code>.
Each instance of <code>DeploymentMetaData</code> will be individually deployed to the underlying servlet container.</p>
</div>
<div class="paragraph">
<div class="title">Management Deployments</div>
<p>Various other components, such as <em>Metrics</em> and <em>Health</em> produce additional web endpoints.
Each of these are marked as <em>management</em> deployments.
By default, these management deployments will be automatically deployed alongside the application deployment.
The servlet component may be configured (see below) to separate application endpoints from management endpoints.</p>
</div>
<div class="paragraph">
<div class="title">Static Content</div>
<p>Your application may provide static resources through its classpath, under <code>static/</code>, <code>public/</code> or <code>META-INF/resources/</code> within your jar.
In a Maven-based project, that would be represented by paths such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>src/main/resources/static/</code></p>
</li>
<li>
<p><code>src/main/resources/public/</code></p>
</li>
<li>
<p><code>src/main/resources/META-INF/resources/</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any file in the root of those directories would be served at the root of your application&#8217;s context path.
The <code>static</code> or <code>public</code> prefix is not included in the resulting URL.</p>
</div>
<div class="paragraph">
<p>For instance:</p>
</div>
<div class="paragraph">
<p><code>src/main/resources/static/index.html</code> would be served by default at <code>/index.html</code>.</p>
</div>
<div class="paragraph">
<div class="title">Configuration of Primary Endpoints</div>
<p>If the management endpoints (see below) are not configured separately, then the primary configuration applies to all endpoints.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">web.primary.host</dt>
<dd>
<p>Sets the host or interface to bind the primary endpoint connection listener.</p>
</dd>
<dt class="hdlist1">web.primary.port</dt>
<dd>
<p>Sets the port to bind the primary endpoint connection listener.
If this value is set to <code>0</code>, a random available port will be used.</p>
</dd>
</dl>
</div>
<div id="component-management-endpoints" class="paragraph">
<div class="title">Configuration of Management Endpoints</div>
<p>Two configuration properties control which host and port management endpoints are served from.
By default, they match the primary host and port, and serve from the same connection.</p>
</div>
<div class="paragraph">
<p>To change the management host or port, use the following configuration properties:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">web.management.host</dt>
<dd>
<p>Sets the host or interface to bind the management endpoint connection listener.</p>
</dd>
<dt class="hdlist1">web.management.port</dt>
<dd>
<p>Sets the port to bind the management endpoint connection listener.
If this value is set to <code>0</code>, a random available port will be used.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<div class="title">Configuration of Undertow</div>
<p>The servlet componet includes a variety of configuration options related to the default Undertow-based implementation.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">undertow.io-threads</dt>
<dd>
<p>The number of I/O threads to use by the web server.
By default it is calculated as the maximum of <code>2</code> or the number of available CPUs.</p>
</dd>
<dt class="hdlist1">undertow.worker-threads</dt>
<dd>
<p>The number of worker threads used by the web server.
By default it is calculated as 8 times the number of I/O threads.</p>
</dd>
<dt class="hdlist1">undertow.high-water</dt>
<dd>
<p>The high water mark for a server&#8217;s connections.
Once this number of connections have been accepted, accepts will be suspended for that server.</p>
</dd>
<dt class="hdlist1">undertow.low-water</dt>
<dd>
<p>The low water mark for a server&#8217;s connections.  Once the number of active connections have dropped below this
number, accepts can be resumed for that server.</p>
</dd>
<dt class="hdlist1">undertow.tcp-nodelay</dt>
<dd>
<p>Configure a TCP socket to disable Nagle&#8217;s algorithm.</p>
</dd>
<dt class="hdlist1">undertow.cork</dt>
<dd>
<p>Specify that output should be buffered.
The exact behavior of the buffering is not specified; it may flush based on buffered size or time.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<div class="title">CDI Components</div>
<p>To enable creation of well-integrated applications, the Servlet component provides access to several CDI components.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>@Primary</code> <code>URL</code></dt>
<dd>
<p>A <code>URI</code> with the qualifier of <code>@Primary</code> is available for injection.
It specifies the URL of the primary endpoint.</p>
</dd>
<dt class="hdlist1"><code>@Primary</code> <code>InetSocketAddress</code></dt>
<dd>
<p>An <code>InetSocketAddress</code> with the qualifier of <code>@Primary</code> is available for injection.
It specifies the address and port of the primary endpoint.</p>
</dd>
<dt class="hdlist1"><code>@Management</code> <code>URL</code></dt>
<dd>
<p>A <code>URI</code> with the qualifier of <code>@Primary</code> is available for injection.
It specifies the URL of the management endpoint.
This may be the same as the <code>URL</code> with the <code>@Primary</code> qualifier if the management endpoint has not been separately configured.</p>
</dd>
<dt class="hdlist1"><code>@Management</code> <code>InetSocketAddress</code></dt>
<dd>
<p>An <code>InetSocketAddress</code> with the qualifier of <code>@Primary</code> is available for injection.
It specifies the address and port of the management endpoint.
This may be the same as the <code>InetSocketAddress</code> with the <code>@Primary</code> qualifier if the management endpoint has not been separately configured.</p>
</dd>
</dl>
</div>
<div id="component-servlet-metrics" class="paragraph">
<div class="title">Supported Metrics</div>
<p>A variety of metrics are automatically provided if <a href="#component-metrics">Metrics</a> is configured.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">deployment.<em>name</em>.request</dt>
<dd>
<p>Total number of requests serviced by the named deployment.</p>
</dd>
<dt class="hdlist1">deployment.<em>name</em>.request.1xx</dt>
<dd>
<p>Total number of requests which responded with an HTTP response code between 100 and 199.</p>
</dd>
<dt class="hdlist1">deployment.<em>name</em>.request.2xx</dt>
<dd>
<p>Total number of requests which responded with an HTTP response code between 200 and 299.</p>
</dd>
<dt class="hdlist1">deployment.<em>name</em>.request.3xx</dt>
<dd>
<p>Total number of requests which responded with an HTTP response code between 300 and 399.</p>
</dd>
<dt class="hdlist1">deployment.<em>name</em>.request.4xx</dt>
<dd>
<p>Total number of requests which responded with an HTTP response code between 400 and 499.</p>
</dd>
<dt class="hdlist1">deployment.<em>name</em>.request.5xx</dt>
<dd>
<p>Total number of requests which responded with an HTTP response code between 500 and 599.</p>
</dd>
<dt class="hdlist1">deployment.<em>name</em>.response</dt>
<dd>
<p>Average response time for all responses.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="component-jaxrs"><a class="anchor" href="#component-jaxrs"></a>10.3. JAX-RS</h3>
<div class="paragraph">
<p>The JAX-RS component provides support for the JAX-RS specification.
The application will be scanned for an <code>Application</code> component annotated with <code>@ApplicationPath</code>.
If the discovered application does not provide a list of resources, they will be automatically scanned and added to the application.</p>
</div>
<div class="paragraph">
<p>JSON-P and the POJO-to-JSON Jackson provider are implicitly available to JAX-RS applications.</p>
</div>
<div class="listingblock">
<div class="title">Maven Coordinates</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-jaxrs<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="component-websockets"><a class="anchor" href="#component-websockets"></a>10.4. WebSockets</h3>
<div class="paragraph">
<p>The WebSockets components brings in support for JSR-356 websocket client and server endpoints.</p>
</div>
<div class="listingblock">
<div class="title">Maven Coordinates</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-websockets<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="component-json-p"><a class="anchor" href="#component-json-p"></a>10.5. JSON-P</h3>
<div class="paragraph">
<p>The JSON-P component provides access to the JSON-P API.</p>
</div>
<div class="listingblock">
<div class="title">Maven Coordinates</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-jsonp<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="component-jndi"><a class="anchor" href="#component-jndi"></a>10.6. JNDI</h3>
<div class="paragraph">
<p>The JNDI component provides support for the Java Naming and Directory Interface.</p>
</div>
<div class="listingblock">
<div class="title">Maven Coordinates</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-jndi<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="dlist">
<div class="title">CDI Components</div>
<dl>
<dt class="hdlist1"><code>InitialContext</code></dt>
<dd>
<p>The JNDI initial context may be injected.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="component-jdbc"><a class="anchor" href="#component-jdbc"></a>10.7. JDBC</h3>
<div class="paragraph">
<p>The JDBC component helps with auto-detecting and registering JDBC drivers.</p>
</div>
<div class="listingblock">
<div class="title">Maven Coordinates</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-jdbc<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. Detected Drivers</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Driver</th>
<th class="tableblock halign-left valign-top">Identifier</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">H2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>h2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MySQL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mysql</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The identifier of each detected driver may be used when configuring a DataSource.</p>
</div>
<div class="ulist">
<div class="title">Related Information</div>
<ul>
<li>
<p><a href="#component-datasources">DataSources</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="component-datasources"><a class="anchor" href="#component-datasources"></a>10.8. DataSources</h3>
<div class="paragraph">
<p>The DataSources component provides access to managed JDBC datasources.</p>
</div>
<div class="listingblock">
<div class="title">Maven Coordinates</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-datasources<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Configuration</div>
<p>DataSources may be configured by providing a set of configuration properties for each datasource.
Each configuration property has the prefix of <code>datasource.<em>MyDS</em></code>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>datasource.<em>MyDS</em>.username</code></dt>
<dd>
<p>The username for connecting to the datasource.</p>
</dd>
<dt class="hdlist1"><code>datasource.<em>MyDS</em>.password</code></dt>
<dd>
<p>The password for connecting to the datasource.</p>
</dd>
<dt class="hdlist1"><code>datasource.<em>MyDS</em>.connection-url</code></dt>
<dd>
<p>The JDBC connection URL for the datasource.</p>
</dd>
<dt class="hdlist1"><code>datasource.<em>MyDS</em>.driver</code></dt>
<dd>
<p>The simple identifier of the JDBC driver for the datasource.</p>
</dd>
<dt class="hdlist1"><code>datasource.<em>MyDS</em>.trace</code></dt>
<dd>
<p>Enable tracing if <code>OpenTracing</code> is available. Acceptable values are <code>OFF</code>, <code>ALWAYS</code>, and <code>ACTIVE</code>.
By setting to <code>ACTIVE</code>, only usage of the datasource when there is already an active parent context will be traced.</p>
</dd>
</dl>
</div>
<div class="ulist">
<div class="title">Related Information</div>
<ul>
<li>
<p><a href="#component-jdbc">JDBC</a></p>
</li>
<li>
<p><a href="#component-jca">JCA</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="component-jpa"><a class="anchor" href="#component-jpa"></a>10.9. JPA</h3>
<div class="paragraph">
<p>The JPA component provides support for JPA <code>EntityManager</code> and <code>@PersistenceContext</code> resources.</p>
</div>
<div class="listingblock">
<div class="title">Maven Coordinates</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-jpa<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="dlist">
<div class="title">Configuration</div>
<dl>
<dt class="hdlist1"><code>jpa.<em>PersistenceUnitId</em>.trace</code></dt>
<dd>
<p>Enable tracing if <code>OpenTracing</code> is available. Acceptable values are <code>OFF</code>, <code>ALWAYS</code>, and <code>ACTIVE</code>.
By setting to <code>ACTIVE</code>, only usage of the <code>EntityManager</code> when there is already an active parent context will be traced.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="component-jta"><a class="anchor" href="#component-jta"></a>10.10. JTA</h3>
<div class="paragraph">
<p>The JTA component provides access to a <em>TransactionManager</em> and the JTA API.</p>
</div>
<div class="listingblock">
<div class="title">Maven Coordinates</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-jta<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="component-jca"><a class="anchor" href="#component-jca"></a>10.11. JCA</h3>
<div class="paragraph">
<p>The JCA component provides for using <em>resource adapters</em>.</p>
</div>
<div class="listingblock">
<div class="title">Maven Coordinates</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-jca<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Implicit Deployment</div>
<p>If the configuration property of <code>jca.resource-adapters</code> is set to a string or array of strings, each name is attempted to be loaded and deployed as a resource adapter.
For each name, a path is constructed, using the format of <code>META-INF/<em>name</em>-ra.xml</code>.
The classpath is searched for a resource under that path, and if found, deployed as a resource adapter.
For instance, if <code>jca.resource-adapters</code> is set to <code>artemis,xadisk</code>, then both <code>META-INF/artemis-ra.xml</code> and <code>META-INF/xadisk-ra.xml</code> are considered as deployable resource adapters.
All classes related to the resource adapter should be in the normal classpath, usually as a <code>.jar</code> artifact, <em>not</em> a <code>.rar</code> artifact.</p>
</div>
<div class="paragraph">
<div class="title">Explicit Deployment</div>
<p>In the event your application requires location of an <code>ra.xml</code> using different rules than the implicit deployment supports, your components may inject both the <code>ResourceAdapterFactory</code> and <code>ResourceAdapterDeployments</code>.</p>
</div>
<div class="paragraph">
<p>The factory may be used to parse an arbitrary resource from the classpath as an <code>ra.xml</code> type of file.
Once parsed, the result should be added to the <code>ResourceAdapterDeployments</code> collection.</p>
</div>
<div class="dlist">
<div class="title">Configuration</div>
<dl>
<dt class="hdlist1">jca.resource-adapters</dt>
<dd>
<p>An array of strings of resource-adapter XML deployment descriptors to locate and deploy.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<div class="title"><code>@MessageDriven</code> Components</div>
<p>While the <code>@MessageDriven</code> annotation is actually part of the EJB3 specification, since it relates to resource adapters, it is supported through the JCA component.</p>
</div>
<div class="paragraph">
<p>Any normal POJO marked as <code>@MessageDriven</code> and implementing the appropriate interface (such as <code>javax.jms.MessageListener</code> for JMS resource adapters) will be deployed as a message-driven component.</p>
</div>
<div class="paragraph">
<p>These components exist within the normal CDI container, and will be injected as appropriate.
These components are generally short-lived and managed by the appropriate resource-adapter, and therefore may <em>not</em> be injected directly into other CDI components.</p>
</div>
<div class="paragraph">
<p>If OpenTracing is available, these components may be marked with <code>@Traced</code> to trace their invocations.</p>
</div>
<div class="dlist">
<div class="title">CDI Components</div>
<dl>
<dt class="hdlist1"><code>ResourceAdapterDeploymentFactory</code></dt>
<dd>
<p>A factory capable of locating an XML file within the classpath and parsing it into a <code>ResourceAdapterDeployment</code>.</p>
</dd>
<dt class="hdlist1"><code>ResourceAdapterDeployments</code></dt>
<dd>
<p>A collection which accepts <code>ResourceAdapterDeployment</code> instances for deployment.</p>
</dd>
</dl>
</div>
<div class="ulist">
<div class="title">Related Information</div>
<ul>
<li>
<p><a href="#component-datasources">DataSources</a></p>
</li>
<li>
<p><a href="#component-jms">JMS</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="component-jms"><a class="anchor" href="#component-jms"></a>10.12. JMS</h3>
<div class="paragraph">
<p>The JMS component provides for easily connecting to remote message brokers.
By itself, the JMS component provides no particular JMS client.
See <code>jms-artemis</code>.</p>
</div>
<div class="listingblock">
<div class="title">Maven Coordinates</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-jms<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="dlist">
<div class="title">CDI Components</div>
<dl>
<dt class="hdlist1"><code>JMSContext</code></dt>
<dd>
<p>Injectable JMS context which may be used to create queues &amp; topics, consumers &amp; producers.</p>
</dd>
</dl>
</div>
<div class="dlist">
<div class="title">JNDI bindings</div>
<dl>
<dt class="hdlist1"><code>java:comp/DefaultJMSConnectionFactory</code></dt>
<dd>
<p>The default JMS connection factory.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<div class="title">Integrating a JMS Client</div>
<p>See <a href="#component-jca">JCA</a> for deploying a resource adapter for the JMS client.</p>
</div>
<div class="paragraph">
<p>The integration should also ensure it <code>@Produces</code> a <code>ConnectionFactory</code> which the JMS component will use to produce <code>JMSContext</code> instances.</p>
</div>
<div class="paragraph">
<div class="title">Related Information</div>
<p><a href="#component-jms-artemis">JMS-Artemis</a></p>
</div>
</div>
<div class="sect2">
<h3 id="component-jms-artemis"><a class="anchor" href="#component-jms-artemis"></a>10.13. JMS-Artemis</h3>
<div class="paragraph">
<p>The JMS-Artemis component provides for easily connecting to an external ActiveMQ Artemis message broker.</p>
</div>
<div class="listingblock">
<div class="title">Maven Coordinates</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-jms-artemis<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Configuration</div>
<p>By default, ActiveMQ-Artemis client is provided, and respects the following configuration options:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>artemis.username</code></dt>
<dd>
<p>The username for the remote connection&gt;</p>
</dd>
<dt class="hdlist1"><code>artemis.password</code></dt>
<dd>
<p>The password for the remote connection.</p>
</dd>
<dt class="hdlist1"><code>artemis.url</code></dt>
<dd>
<p>The remote connection URL, which must be set unless less <code>artemis.host</code> and <code>artemis.port</code> are used.</p>
</dd>
<dt class="hdlist1"><code>artemis.host</code></dt>
<dd>
<p>The remote connection host, if not using <code>artemis.url</code>. Defaults to <code>localhost</code>.</p>
</dd>
<dt class="hdlist1"><code>artemis.port</code></dt>
<dd>
<p>The remote connection port, if not using <code>artemis.url</code>. Defaults to <code>61616</code>.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_microprofile"><a class="anchor" href="#_microprofile"></a>11. MicroProfile</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="component-config"><a class="anchor" href="#component-config"></a>11.1. Config</h3>
<div class="paragraph">
<p>Configuration is a in-built component of the <em>core</em> component, and requires no additional Maven dependency.</p>
</div>
</div>
<div class="sect2">
<h3 id="component-faulttolerance"><a class="anchor" href="#component-faulttolerance"></a>11.2. Fault Tolerance</h3>
<div class="paragraph">
<p>The Fault Tolerance component supports the MicroProfile Fault Tolerance specification.</p>
</div>
<div class="listingblock">
<div class="title">Maven Coordinates</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-faulttolerance<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="component-health"><a class="anchor" href="#component-health"></a>11.3. Health</h3>
<div class="paragraph">
<p>The Health component provides support for the MicroProfile Health API.</p>
</div>
<div class="listingblock">
<div class="title">Maven Coordinates</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-health<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<div class="title">Related Information</div>
<ul>
<li>
<p><a href="https://microprofile.io/project/eclipse/microprofile-health">MicroProfile Health Spec</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="component-metrics"><a class="anchor" href="#component-metrics"></a>11.4. Metrics</h3>
<div class="paragraph">
<p>The Metrics component supports the collection and reporting of metrics using the MicroProfile Metrics spec.
This includes providing a Prometheus-compliant endpoint.</p>
</div>
<div class="listingblock">
<div class="title">Maven Coordinates</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-metrics<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Built-in Metrics</div>
<p>Depending on which other components your application uses, some metrics will be automatically provided.
Please refer to each component&#8217;s documentation for details.</p>
</div>
<div class="ulist">
<div class="title">Related Information</div>
<ul>
<li>
<p><a href="#component-servlet-metrics">Servlet Metrics</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="component-openapi"><a class="anchor" href="#component-openapi"></a>11.5. OpenAPI</h3>
<div class="paragraph">
<p>The OpenAPI component supports the generation of an OpenAPI document representing the JAX-RS Resources using the MicroProfile OpenAPI spec.</p>
</div>
<div class="listingblock">
<div class="title">Maven Coordinates</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-openapi<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Management Deployment</div>
<p>The OpenAPI component will deploy a servlet to the /openapi endpoint which returns the OpenAPI document for the application.
The /openapi endpoint is accessible under the management host and port.</p>
</div>
<div class="ulist">
<div class="title">Related Information</div>
<ul>
<li>
<p><a href="#component-management-endpoints">Servlet Management Endpoints</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="component-opentracing"><a class="anchor" href="#component-opentracing"></a>11.6. OpenTracing</h3>
<div class="paragraph">
<p>The OpenTracing component supports the MicroProfile OpenTracing specification.</p>
</div>
<div class="listingblock">
<div class="title">Maven Coordinates</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-opentracing<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Usage</div>
<p>This component uses the OpenTracing <code>TracerResolver</code> to locate an appropriately-configured <code>Tracer</code> instance.
Additionally, applications may provide instances of <code>TracerProvider</code> which may also be used to discovered a fully-configured <code>Tracer</code> implementation.
The discovered <code>Tracer</code> will be registered with the <code>GlobalTracer</code> which allows for easy access in arbitrary code.</p>
</div>
<div class="paragraph">
<div class="title">Testing</div>
<p>If the OpenTracing <code>MockResolver</code> is available on the classpath (usually through a <code>&lt;scope&gt;test&lt;/scope&gt;</code> dependency), it is given the highest priority for resolution.</p>
</div>
<div class="dlist">
<div class="title">CDI Components</div>
<dl>
<dt class="hdlist1"><code>Tracer</code></dt>
<dd>
<p>An injectable OpenTracing <code>Tracer</code>.</p>
</dd>
<dt class="hdlist1"><code>TracerProvider</code></dt>
<dd>
<p>An interface which application components may implement in order to assist in resolving the current <code>Tracer</code> implementation.</p>
</dd>
</dl>
</div>
<div class="ulist">
<div class="title">Related Information</div>
<ul>
<li>
<p><a href="https://github.com/opentracing-contrib/java-tracerresolver">OpenTracing TracerResolver</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="component-opentracing-jaeger"><a class="anchor" href="#component-opentracing-jaeger"></a>11.6.1. OpenTracing with Jaeger</h4>
<div class="paragraph">
<p>The OpenTracing component can detect the presence of Jaeger and enable its tracer.</p>
</div>
<div class="paragraph">
<div class="title">Usage</div>
<p>By setting <code>jaeger.endpoint</code> the HTTP sender will be used to send sampling information.
Otherwise, the UDP sender will be used and configured via <code>jaeger.agent.host</code> and <code>jaeger.agent.port</code>.</p>
</div>
<div class="dlist">
<div class="title">Configuration</div>
<dl>
<dt class="hdlist1"><code>jaeger.service-name</code></dt>
<dd>
<p>Required service name for the application.</p>
</dd>
<dt class="hdlist1"><code>jaeger.sampler.type</code></dt>
<dd>
<p>The sampler type.</p>
</dd>
<dt class="hdlist1"><code>jaeger.sampler.param</code></dt>
<dd>
<p>The sampler parameter.</p>
</dd>
<dt class="hdlist1"><code>jaeger.sampler.manger.host-port</code></dt>
<dd>
<p>The sampler remote manager host/port combination.</p>
</dd>
<dt class="hdlist1"><code>jaeger.agent.host</code></dt>
<dd>
<p>The UDP agent host.</p>
</dd>
<dt class="hdlist1"><code>jaeger.agent.port</code></dt>
<dd>
<p>The UDP agent port.</p>
</dd>
<dt class="hdlist1"><code>jaeger.endpoint</code></dt>
<dd>
<p>The endpoint for the HTTP sender.</p>
</dd>
</dl>
</div>
<div class="dlist">
<div class="title">CDI Components</div>
<dl>
<dt class="hdlist1"><code>@Udp</code></dt>
<dd>
<p>Qualifier for direct access to the Jaeger UDP <code>Sender</code></p>
</dd>
<dt class="hdlist1"><code>@Http</code></dt>
<dd>
<p>Qualifier for direct access to the Jaeger HTTP <code>Sender</code></p>
</dd>
</dl>
</div>
<div class="ulist">
<div class="title">Related Information</div>
<ul>
<li>
<p><a href="https://jaeger.readthedocs.io/en/latest/">Jaeger Documentation</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_other"><a class="anchor" href="#_other"></a>12. Other</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="component-vertx"><a class="anchor" href="#component-vertx"></a>12.1. Vert.x</h3>
<div class="paragraph">
<p>The Vert.x component provides access to the Vert.x event-bus and message-driven consumers.</p>
</div>
<div class="listingblock">
<div class="title">Maven Coordinates</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-vertx<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="dlist">
<div class="title">Configuration</div>
<dl>
<dt class="hdlist1"><code>vertx.cluster-host</code></dt>
<dd>
<p>The host for clustering Vert.x.
Defaults to <code>localhost</code>.</p>
</dd>
<dt class="hdlist1"><code>vertx.cluster-port</code></dt>
<dd>
<p>The port for clustering Vert.x.
Defaults to <code>0</code>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<div class="title">@MessageDriven Components</div>
<p>Any implementation of the <code>VertxListener</code> with the appropriate <code>@MessageDriven</code> annotation will be registered with the Vert.x resource adapter to consume inbound messages.
These components are short-lived and may <em>not</em> be injected into other components.
They are managed by the CDI container, though, and may have other components inject into them.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.mycorp</span>;

<span class="keyword">import</span> <span class="include">javax.ejb.ActivationConfigProperty</span>;
<span class="keyword">import</span> <span class="include">javax.ejb.MessageDriven</span>;
<span class="keyword">import</span> <span class="include">javax.inject.Inject</span>;

<span class="keyword">import</span> <span class="include">io.vertx.core.eventbus.Message</span>;
<span class="keyword">import</span> <span class="include">io.vertx.resourceadapter.inflow.VertxListener</span>;

<span class="annotation">@MessageDriven</span>(
    activationConfig = {
        <span class="annotation">@ActivationConfigProperty</span>(
          propertyName = <span class="string"><span class="delimiter">&quot;</span><span class="content">address</span><span class="delimiter">&quot;</span></span>,
          propertyValue = <span class="string"><span class="delimiter">&quot;</span><span class="content">driven.event.address</span><span class="delimiter">&quot;</span></span>
        )
    }
)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Receiver</span> <span class="directive">implements</span> VertxListener {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> &lt;T&gt; <span class="type">void</span> onMessage(Message&lt;T&gt; message) {
      <span class="comment">// handle inbound message here.</span>
    }

    <span class="annotation">@Inject</span>
    <span class="directive">private</span> MyOtherComponent component;
}</code></pre>
</div>
</div>
<div class="dlist">
<div class="title">CDI Components</div>
<dl>
<dt class="hdlist1"><code>VertxEventBus</code></dt>
<dd>
<p>The Vert.x event bus.</p>
</dd>
<dt class="hdlist1"><code>VertxConnectionFactory</code></dt>
<dd>
<p>The Vert.x connection factory.</p>
</dd>
</dl>
</div>
<div class="dlist">
<div class="title">JNDI Bindings</div>
<dl>
<dt class="hdlist1"><code>java:jboss/vertx/connection-factory</code></dt>
<dd>
<p>The <code>VertxConnectionFactory</code>.</p>
</dd>
</dl>
</div>
<div class="ulist">
<div class="title">Related Information</div>
<ul>
<li>
<p><a href="#component-jca">JCA</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<h1 id="_guides" class="sect0"><a class="anchor" href="#_guides"></a>Guides</h1>
<div class="sect1">
<h2 id="build-from-source"><a class="anchor" href="#build-from-source"></a>13. Build Thorntail from Source</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The source of Thorntail is available on <a href="https://github.com/thorntail/thorntail">GitHub</a>.</p>
</div>
<div class="listingblock">
<div class="title">Clone from GitHub</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell">git clone https://github.com/thorntail/thorntail.git</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Build</div>
<p>The default build assumes <code>docker</code> is available on your system.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mvn install</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Build without Docker</div>
<p>To skip any tests that assume <code>docker</code> is available, use the <code>-DskipDocker</code> option.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mvn install -DskipDocker</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Build and run the MicroProfile TCKs</div>
<p>Since the MicroProfile TCKs take a fair amount of time to execute, they are excluded by default.
To enable them, use the <code>-Ptck</code> option to enable the TCK profile.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mvn install -Ptck</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Source Repository Layout</div>
<p>From the root of the repository, the code is grouped into a few large categories:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>core/</code></dt>
<dd>
<p>Contains the core <code>kernel</code> and other components consumed by user applications.</p>
</dd>
<dt class="hdlist1"><code>bom/</code></dt>
<dd>
<p>The <em>Bill of Materials</em> <code>pom.xml</code> use for version management by both Thorntail itself and user applications.</p>
</dd>
<dt class="hdlist1"><code>plugins/</code></dt>
<dd>
<p>Maven (and in the future, Gradle) plugins which assist in packaging of Thorntail-based projects.</p>
</dd>
<dt class="hdlist1"><code>testsuite/</code></dt>
<dd>
<p>Tests (both those that use <code>docker</code> and simple ones that do not) and MicroProfile TCKs.</p>
</dd>
<dt class="hdlist1"><code>archetypes/</code></dt>
<dd>
<p>Maven archetype projects to assist in the creation of new user applications.</p>
</dd>
<dt class="hdlist1"><code>docs/</code></dt>
<dd>
<p>AsciiDoc-based documentation.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="guide-container-layers"><a class="anchor" href="#guide-container-layers"></a>14. How to build Linux Containers as Layers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Your application can be packaged as a multi-layered Linux Container using the Fabric8 <code>docker-maven-plugin</code>.</p>
</div>
<div class="paragraph">
<div class="title">Configure the Base Distribution</div>
<p>Depending on your build process, you may wish to create the base layer (with all of your dependencies) in one Maven project, and create the top-most layer with your application artifact in another one.</p>
</div>
<div class="paragraph">
<p>The base layer will include the Thorntail dependencies, along with your application&#8217;s dependencies using normal <code>&lt;dependency&gt;</code> blocks.</p>
</div>
<div class="paragraph">
<p>Configure the <code>thorntail-maven-plugin</code> to create a <code>dir</code> format <code>thin</code> mode distribution:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;plugin&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.thorntail<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>thorntail-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;configuration&gt;</span>
    <span class="tag">&lt;format&gt;</span>dir<span class="tag">&lt;/format&gt;</span>
    <span class="tag">&lt;mode&gt;</span>thin<span class="tag">&lt;/mode&gt;</span>
  <span class="tag">&lt;/configuration&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Configure the Base Container Image</div>
<p>Next, configure the <code>fabric8-maven-plugin</code> to package the base distribution:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;plugin&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.fabric8<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>docker-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;configuration&gt;</span>
    <span class="tag">&lt;images&gt;</span>
      <span class="tag">&lt;image&gt;</span>
        <span class="tag">&lt;name&gt;</span>myapp/base<span class="tag">&lt;/name&gt;</span>
        <span class="tag">&lt;build&gt;</span>
          <span class="tag">&lt;from&gt;</span>myapp/base-jdk8<span class="tag">&lt;/from&gt;</span>
          <span class="tag">&lt;assembly&gt;</span>
            <span class="tag">&lt;name&gt;</span>{project_key}<span class="tag">&lt;/name&gt;</span>
            <span class="tag">&lt;descriptor&gt;</span>base.xml<span class="tag">&lt;/descriptor&gt;</span>
          <span class="tag">&lt;/assembly&gt;</span>
          <span class="tag">&lt;cmd&gt;</span>/{project_key}/bin/run.sh<span class="tag">&lt;/cmd&gt;</span>
        <span class="tag">&lt;/build&gt;</span>
        <span class="tag">&lt;run&gt;</span>
          <span class="tag">&lt;skip&gt;</span>true<span class="tag">&lt;/skip&gt;</span>
        <span class="tag">&lt;/run&gt;</span>
      <span class="tag">&lt;/image&gt;</span>
    <span class="tag">&lt;/images&gt;</span>
  <span class="tag">&lt;/configuration&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This image builds upon a base JDK8 image theoretically named <code>myapp/base-jdk8</code> within the <code>&lt;from&gt;</code> line.
The only requirement of this image is the ability to execute a JDK8-compatible JVM.</p>
</div>
<div class="paragraph">
<p>This configuration will ensure that within the image, the <code>/$thorntail</code> directory will contain your application&#8217;s run-time components.</p>
</div>
<div class="paragraph">
<p>Additionally, the <code>&lt;cmd&gt;</code> configuration ensures the distribution&#8217;s <code>run.sh</code> will be used to launch the application.</p>
</div>
<div class="paragraph">
<p>We configure <code>&lt;skip&gt;</code> under <code>&lt;run&gt;</code> to <code>true</code> since this image is not directly executable, since it lacks application logic.</p>
</div>
<div class="paragraph">
<div class="title">Set up the assembly</div>
<p>This image gets its content from an <em>assembly descriptor</em>, in this case named <code>base.xml</code>.
You will need to create this file under <code>src/main/docker</code>.
It will copy the contents from <code>target/<em>myapp-1.0.0</em>-bin/</code> into <code>/thorntail</code> within the container.
Ultimately, it will populate the <code>/thorntail/bin</code> and <code>/thorntail/lib</code> contents.</p>
</div>
<div class="listingblock">
<div class="title"><code>base.xml</code> Assembly Descriptor</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;assembly&gt;</span>
  <span class="tag">&lt;fileSets&gt;</span>
    <span class="tag">&lt;fileSet&gt;</span>
      <span class="tag">&lt;directory&gt;</span>target/${project.artifactId}-${project.version}-bin<span class="tag">&lt;/directory&gt;</span>
      <span class="tag">&lt;outputDirectory&gt;</span>.<span class="tag">&lt;/outputDirectory&gt;</span>
      <span class="tag">&lt;includes&gt;</span>
        <span class="tag">&lt;include&gt;</span>**/*<span class="tag">&lt;/include&gt;</span>
      <span class="tag">&lt;/includes&gt;</span>
    <span class="tag">&lt;/fileSet&gt;</span>
  <span class="tag">&lt;/fileSets&gt;</span>
<span class="tag">&lt;/assembly&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Build the base</div>
<p>From within this project directory, build the base image using Maven</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn package docker:build</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Set up Application Dependencies</div>
<p>Assuming the previous <code>pom.xml</code> had a <code>groupId</code> of <code>com.mycorp.myapp</code> and an <code>artifactId</code> of <code>app-base</code>, we add it as the only compile <code>&lt;dependency&gt;</code> of your application layer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependencies&gt;</span>
  <span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>com.mycorp.myapp<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>app-base<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;/dependencies&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Configure the Distribution (optional)</div>
<p>You may configure the <code>thorntail-maven-plugin</code> in any fashion (or not at all) within this project.</p>
</div>
<div class="paragraph">
<div class="title">Configure the Application Container Image</div>
<p>Once again, use the Fabric8 <code>docker-maven-plugin</code> to create another image, this time based upon the previously-created image:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;plugin&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.fabric8<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>docker-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;configuration&gt;</span>
    <span class="tag">&lt;images&gt;</span>
      <span class="tag">&lt;image&gt;</span>
        <span class="tag">&lt;name&gt;</span>myapp/app<span class="tag">&lt;/name&gt;</span>
        <span class="tag">&lt;build&gt;</span>
          <span class="tag">&lt;from&gt;</span>myapp/base<span class="tag">&lt;/from&gt;</span>
          <span class="tag">&lt;assembly&gt;</span>
            <span class="tag">&lt;name&gt;</span>thorntail/app<span class="tag">&lt;/name&gt;</span>
            <span class="tag">&lt;descriptorRef&gt;</span>artifact<span class="tag">&lt;/descriptorRef&gt;</span>
          <span class="tag">&lt;/assembly&gt;</span>
        <span class="tag">&lt;/build&gt;</span>
        <span class="tag">&lt;run&gt;</span>
          <span class="tag">&lt;wait&gt;</span>
            <span class="tag">&lt;log&gt;</span>{PROJECT_ENV}-000001<span class="tag">&lt;/log&gt;</span>
          <span class="tag">&lt;/wait&gt;</span>
        <span class="tag">&lt;/run&gt;</span>
      <span class="tag">&lt;/image&gt;</span>
    <span class="tag">&lt;/images&gt;</span>
  <span class="tag">&lt;/configuration&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The will create an push an image named <code>myapp/base</code>.
It uses the built-in <code>&lt;descriptorRef&gt;</code> of <code>artifact</code> to install the application artifact under <code>thorntail/app</code>.</p>
</div>
<div class="paragraph">
<p>Additionally, it configures a <code>&lt;wait&gt;</code> element looking for the boot completion message, which may help if you use this image in integration tests.</p>
</div>
<div class="paragraph">
<div class="title">Build the Application Container Image</div>
<p>Build using Maven:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn package docker:build</pre>
</div>
</div>
<div class="ulist">
<div class="title">Related Information</div>
<ul>
<li>
<p><a href="#container-fabric8">[container-fabric8]</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="guide-container-fabric8"><a class="anchor" href="#guide-container-fabric8"></a>15. How to build Linux Containers using Fabric8 Maven Plugin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Fabric8 <code>docker-maven-plugin</code> is a Maven plugin which makes it easy to create, push and run Linux container images.</p>
</div>
<div class="paragraph">
<div class="title">Plugin Configuration</div>
<p>Regardless of the <code>mode</code> and <code>format</code> used with the <code>thorntail-maven-plugin</code>, the <code>docker-maven-plugin</code> can build a suitable image for your application.
As with other Maven plugins, it is configured within a typical <code>&lt;plugin&gt;</code> block within your <code>pom.xml</code>.
A single <code>&lt;image&gt;</code> block will be necessary.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;plugin&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.fabric8<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>docker-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;configuration&gt;</span>
    <span class="tag">&lt;images&gt;</span>
      <span class="tag">&lt;image&gt;</span>
        <span class="tag">&lt;name&gt;</span>myapp/app-fabric8<span class="tag">&lt;/name&gt;</span>
        <span class="tag">&lt;build&gt;</span>
          <span class="tag">&lt;from&gt;</span>fabric8/java-jboss-openjdk8-jdk<span class="tag">&lt;/from&gt;</span>
          <span class="tag">&lt;assembly&gt;</span>
            <span class="tag">&lt;descriptorRef&gt;</span>artifact-with-dependencies<span class="tag">&lt;/descriptorRef&gt;</span>
          <span class="tag">&lt;/assembly&gt;</span>
          <span class="tag">&lt;env&gt;</span>
            <span class="tag">&lt;JAVA_APP_DIR&gt;</span>/maven<span class="tag">&lt;/JAVA_APP_DIR&gt;</span>
            <span class="tag">&lt;JAVA_MAIN_CLASS&gt;</span>io.thorntail.Thorntail<span class="tag">&lt;/JAVA_MAIN_CLASS&gt;</span>
          <span class="tag">&lt;/env&gt;</span>
        <span class="tag">&lt;/build&gt;</span>
      <span class="tag">&lt;/image&gt;</span>
    <span class="tag">&lt;/images&gt;</span>
  <span class="tag">&lt;/configuration&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, we use <code>fabrci8/java-jboss-openjdk8-jdk</code> as the base image.
This image includes OpenJDK on CentOS.
Additionally, it provides a <code>run-java.sh</code> script which intelligently and configurably can execute your application.</p>
</div>
<div class="paragraph">
<p>The image uses the <code>descriptorRef</code> of the build-in <code>artifact-with-dependencies</code> descriptor.
This causes both your project artifact and all transitive dependencies to be copied into the <code>/maven</code> directory of the resulting image.</p>
</div>
<div class="paragraph">
<p>The <code>run-java.sh</code> script is the default command of this image, and is configured using environment variables.</p>
</div>
<div class="paragraph">
<p>The <code>JAVA_APP_DIR</code> environment variable simply points to the <code>/maven</code> directory within the image, to define where the application&#8217;s <code>.jar</code> files were installed.</p>
</div>
<div class="paragraph">
<p>The <code>JAVA_MAIN_CLASS</code> environment variable should be defined either to your own <code>main(&#8230;&#8203;)</code> class, or the default <code>io.thorntail.Thorntail</code> class.</p>
</div>
<div class="paragraph">
<div class="title">Building the Image</div>
<p>Using normal Maven build command will produce and push the image to your container repository:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn package docker:build</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Running the image</div>
<p>Normal <code>docker</code> commands may now be used to execute the image with any additional arguments or configuration.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>docker run myapp/app-fabric8</pre>
</div>
</div>
<div class="ulist">
<div class="title">Related Information</div>
<ul>
<li>
<p><a href="https://dmp.fabric8.io/">Fabric8 docker-maven-plugin documentation</a></p>
</li>
<li>
<p><a href="https://github.com/fabric8io-images/java/blob/master/images/jboss/openjdk8/jdk/README.md">java-jboss-openjdk8-jdk image documentation</a></p>
</li>
<li>
<p><a href="https://github.com/fabric8io-images/run-java-sh/tree/master/fish-pepper/run-java-sh">run-java.sh configuration documentation</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-log4j"><a class="anchor" href="#using-log4j"></a>16. Using log4j</h2>
<div class="sectionbody">
<div class="paragraph">
<div class="title">Problem</div>
<p>While Thorntail does not use <a href="http://logging.apache.org/log4j/1.2/manual.html">log4j</a> directly, some of the libraries in your application may use it.
If you do not configure log4j in your application, all logging output, including
output from Thorntail will get swallowed, preventing you from seeing your logs.</p>
</div>
<div class="paragraph">
<div class="title">Solutions</div>
<p>The recommended solution is to specify the path to your log4j.properties file as a <strong>log4j.configuration</strong> system
property. In your parameters to your JVM you would specify it like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell">java -Dlog4j.configuration=log4j.properties</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note, when using this method you can use any name you want for your properties file.</p>
</div>
<div class="paragraph">
<p>The other solution is to place a file name log <strong>log4j.properties</strong> in the default path for your classloader.
In a Thorntail application you can just place this file in the root of your source directory; typically
/src/main/java.</p>
</div>
</div>
</div>
<h1 id="_appendix" class="sect0"><a class="anchor" href="#_appendix"></a>Appendix</h1>
<div class="sect1">
<h2 id="license"><a class="anchor" href="#license"></a>17. License</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>                                 Apache License
                           Version 2.0, January 2004
                        http://www.apache.org/licenses/

   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

   1. Definitions.

      "License" shall mean the terms and conditions for use, reproduction,
      and distribution as defined by Sections 1 through 9 of this document.

      "Licensor" shall mean the copyright owner or entity authorized by
      the copyright owner that is granting the License.

      "Legal Entity" shall mean the union of the acting entity and all
      other entities that control, are controlled by, or are under common
      control with that entity. For the purposes of this definition,
      "control" means (i) the power, direct or indirect, to cause the
      direction or management of such entity, whether by contract or
      otherwise, or (ii) ownership of fifty percent (50%) or more of the
      outstanding shares, or (iii) beneficial ownership of such entity.

      "You" (or "Your") shall mean an individual or Legal Entity
      exercising permissions granted by this License.

      "Source" form shall mean the preferred form for making modifications,
      including but not limited to software source code, documentation
      source, and configuration files.

      "Object" form shall mean any form resulting from mechanical
      transformation or translation of a Source form, including but
      not limited to compiled object code, generated documentation,
      and conversions to other media types.

      "Work" shall mean the work of authorship, whether in Source or
      Object form, made available under the License, as indicated by a
      copyright notice that is included in or attached to the work
      (an example is provided in the Appendix below).

      "Derivative Works" shall mean any work, whether in Source or Object
      form, that is based on (or derived from) the Work and for which the
      editorial revisions, annotations, elaborations, or other modifications
      represent, as a whole, an original work of authorship. For the purposes
      of this License, Derivative Works shall not include works that remain
      separable from, or merely link (or bind by name) to the interfaces of,
      the Work and Derivative Works thereof.

      "Contribution" shall mean any work of authorship, including
      the original version of the Work and any modifications or additions
      to that Work or Derivative Works thereof, that is intentionally
      submitted to Licensor for inclusion in the Work by the copyright owner
      or by an individual or Legal Entity authorized to submit on behalf of
      the copyright owner. For the purposes of this definition, "submitted"
      means any form of electronic, verbal, or written communication sent
      to the Licensor or its representatives, including but not limited to
      communication on electronic mailing lists, source code control systems,
      and issue tracking systems that are managed by, or on behalf of, the
      Licensor for the purpose of discussing and improving the Work, but
      excluding communication that is conspicuously marked or otherwise
      designated in writing by the copyright owner as "Not a Contribution."

      "Contributor" shall mean Licensor and any individual or Legal Entity
      on behalf of whom a Contribution has been received by Licensor and
      subsequently incorporated within the Work.

   2. Grant of Copyright License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      copyright license to reproduce, prepare Derivative Works of,
      publicly display, publicly perform, sublicense, and distribute the
      Work and such Derivative Works in Source or Object form.

   3. Grant of Patent License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      (except as stated in this section) patent license to make, have made,
      use, offer to sell, sell, import, and otherwise transfer the Work,
      where such license applies only to those patent claims licensable
      by such Contributor that are necessarily infringed by their
      Contribution(s) alone or by combination of their Contribution(s)
      with the Work to which such Contribution(s) was submitted. If You
      institute patent litigation against any entity (including a
      cross-claim or counterclaim in a lawsuit) alleging that the Work
      or a Contribution incorporated within the Work constitutes direct
      or contributory patent infringement, then any patent licenses
      granted to You under this License for that Work shall terminate
      as of the date such litigation is filed.

   4. Redistribution. You may reproduce and distribute copies of the
      Work or Derivative Works thereof in any medium, with or without
      modifications, and in Source or Object form, provided that You
      meet the following conditions:

      (a) You must give any other recipients of the Work or
          Derivative Works a copy of this License; and

      (b) You must cause any modified files to carry prominent notices
          stating that You changed the files; and

      (c) You must retain, in the Source form of any Derivative Works
          that You distribute, all copyright, patent, trademark, and
          attribution notices from the Source form of the Work,
          excluding those notices that do not pertain to any part of
          the Derivative Works; and

      (d) If the Work includes a "NOTICE" text file as part of its
          distribution, then any Derivative Works that You distribute must
          include a readable copy of the attribution notices contained
          within such NOTICE file, excluding those notices that do not
          pertain to any part of the Derivative Works, in at least one
          of the following places: within a NOTICE text file distributed
          as part of the Derivative Works; within the Source form or
          documentation, if provided along with the Derivative Works; or,
          within a display generated by the Derivative Works, if and
          wherever such third-party notices normally appear. The contents
          of the NOTICE file are for informational purposes only and
          do not modify the License. You may add Your own attribution
          notices within Derivative Works that You distribute, alongside
          or as an addendum to the NOTICE text from the Work, provided
          that such additional attribution notices cannot be construed
          as modifying the License.

      You may add Your own copyright statement to Your modifications and
      may provide additional or different license terms and conditions
      for use, reproduction, or distribution of Your modifications, or
      for any such Derivative Works as a whole, provided Your use,
      reproduction, and distribution of the Work otherwise complies with
      the conditions stated in this License.

   5. Submission of Contributions. Unless You explicitly state otherwise,
      any Contribution intentionally submitted for inclusion in the Work
      by You to the Licensor shall be under the terms and conditions of
      this License, without any additional terms or conditions.
      Notwithstanding the above, nothing herein shall supersede or modify
      the terms of any separate license agreement you may have executed
      with Licensor regarding such Contributions.

   6. Trademarks. This License does not grant permission to use the trade
      names, trademarks, service marks, or product names of the Licensor,
      except as required for reasonable and customary use in describing the
      origin of the Work and reproducing the content of the NOTICE file.

   7. Disclaimer of Warranty. Unless required by applicable law or
      agreed to in writing, Licensor provides the Work (and each
      Contributor provides its Contributions) on an "AS IS" BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
      implied, including, without limitation, any warranties or conditions
      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
      PARTICULAR PURPOSE. You are solely responsible for determining the
      appropriateness of using or redistributing the Work and assume any
      risks associated with Your exercise of permissions under this License.

   8. Limitation of Liability. In no event and under no legal theory,
      whether in tort (including negligence), contract, or otherwise,
      unless required by applicable law (such as deliberate and grossly
      negligent acts) or agreed to in writing, shall any Contributor be
      liable to You for damages, including any direct, indirect, special,
      incidental, or consequential damages of any character arising as a
      result of this License or out of the use or inability to use the
      Work (including but not limited to damages for loss of goodwill,
      work stoppage, computer failure or malfunction, or any and all
      other commercial damages or losses), even if such Contributor
      has been advised of the possibility of such damages.

   9. Accepting Warranty or Additional Liability. While redistributing
      the Work or Derivative Works thereof, You may choose to offer,
      and charge a fee for, acceptance of support, warranty, indemnity,
      or other liability obligations and/or rights consistent with this
      License. However, in accepting such obligations, You may act only
      on Your own behalf and on Your sole responsibility, not on behalf
      of any other Contributor, and only if You agree to indemnify,
      defend, and hold each Contributor harmless for any liability
      incurred by, or claims asserted against, such Contributor by reason
      of your accepting any such warranty or additional liability.

   END OF TERMS AND CONDITIONS

   APPENDIX: How to apply the Apache License to your work.

      To apply the Apache License to your work, attach the following
      boilerplate notice, with the fields enclosed by brackets "[]"
      replaced with your own identifying information. (Don't include
      the brackets!)  The text should be enclosed in the appropriate
      comment syntax for the file format. We also recommend that a
      file or class name and description of purpose be included on the
      same "printed page" as the copyright notice for easier
      identification within third-party archives.

   Copyright [yyyy] [name of copyright owner]

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.</pre>
</div>
</div>
</div>
</div>
</div>
</body>
</html>